<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Results | Modelling Altcoin Price Variation with Sentiment Based Predictors</title>
  <meta name="description" content="Chapter 4 Results | Modelling Altcoin Price Variation with Sentiment Based Predictors" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Results | Modelling Altcoin Price Variation with Sentiment Based Predictors" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Results | Modelling Altcoin Price Variation with Sentiment Based Predictors" />
  
  
  

<meta name="author" content="Daniel Spottiswood" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="3-method.html"/>
<link rel="next" href="discussion.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />












</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./"></a></li>
<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> thesisdowndss::thesis_pdf: default</a></li>
<li class="chapter" data-level="" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="literature-review.html"><a href="literature-review.html"><i class="fa fa-check"></i>Literature Review</a></li>
<li class="chapter" data-level="2" data-path="2-data.html"><a href="2-data.html"><i class="fa fa-check"></i><b>2</b> Data</a><ul>
<li class="chapter" data-level="2.1" data-path="2-data.html"><a href="2-data.html#twitter"><i class="fa fa-check"></i><b>2.1</b> Twitter</a><ul>
<li class="chapter" data-level="2.1.1" data-path="2-data.html"><a href="2-data.html#tweet-removal"><i class="fa fa-check"></i><b>2.1.1</b> Tweet Removal</a></li>
<li class="chapter" data-level="2.1.2" data-path="2-data.html"><a href="2-data.html#sentiment-analysis"><i class="fa fa-check"></i><b>2.1.2</b> Sentiment Analysis</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="2-data.html"><a href="2-data.html#google-search-volume"><i class="fa fa-check"></i><b>2.2</b> Google Search Volume</a></li>
<li class="chapter" data-level="2.3" data-path="2-data.html"><a href="2-data.html#price-and-volume"><i class="fa fa-check"></i><b>2.3</b> Price and Volume</a></li>
<li class="chapter" data-level="2.4" data-path="2-data.html"><a href="2-data.html#exploratory-data-analysis"><i class="fa fa-check"></i><b>2.4</b> Exploratory Data Analysis</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-method.html"><a href="3-method.html"><i class="fa fa-check"></i><b>3</b> Methodology</a><ul>
<li class="chapter" data-level="3.1" data-path="3-method.html"><a href="3-method.html#log-returns"><i class="fa fa-check"></i><b>3.1</b> Log Returns</a></li>
<li class="chapter" data-level="3.2" data-path="3-method.html"><a href="3-method.html#xgboost"><i class="fa fa-check"></i><b>3.2</b> XGBoost</a></li>
<li class="chapter" data-level="3.3" data-path="3-method.html"><a href="3-method.html#long-short-term-memory"><i class="fa fa-check"></i><b>3.3</b> Long Short-Term Memory</a><ul>
<li class="chapter" data-level="3.3.1" data-path="3-method.html"><a href="3-method.html#layers"><i class="fa fa-check"></i><b>3.3.1</b> Layers</a></li>
<li class="chapter" data-level="3.3.2" data-path="3-method.html"><a href="3-method.html#dropout"><i class="fa fa-check"></i><b>3.3.2</b> Dropout</a></li>
<li class="chapter" data-level="3.3.3" data-path="3-method.html"><a href="3-method.html#preprocessing"><i class="fa fa-check"></i><b>3.3.3</b> Preprocessing</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-results.html"><a href="4-results.html"><i class="fa fa-check"></i><b>4</b> Results</a><ul>
<li class="chapter" data-level="4.1" data-path="4-results.html"><a href="4-results.html#trading-strategies"><i class="fa fa-check"></i><b>4.1</b> Trading Strategies</a></li>
<li class="chapter" data-level="4.2" data-path="4-results.html"><a href="4-results.html#performance"><i class="fa fa-check"></i><b>4.2</b> Performance</a></li>
<li class="chapter" data-level="4.3" data-path="4-results.html"><a href="4-results.html#performance-net-fees"><i class="fa fa-check"></i><b>4.3</b> Performance Net Fees</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="discussion.html"><a href="discussion.html"><i class="fa fa-check"></i>Discussion</a><ul>
<li class="chapter" data-level="4.4" data-path="discussion.html"><a href="discussion.html#limitations"><i class="fa fa-check"></i><b>4.4</b> Limitations</a></li>
<li class="chapter" data-level="4.5" data-path="discussion.html"><a href="discussion.html#conclusion"><i class="fa fa-check"></i><b>4.5</b> Conclusion</a></li>
<li class="chapter" data-level="4.6" data-path="discussion.html"><a href="discussion.html#future-work"><i class="fa fa-check"></i><b>4.6</b> Future Work</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span><ul>
<li class="chapter" data-level="7" data-path="discussion.html"><a href="discussion.html#model-features"><i class="fa fa-check"></i><b>7</b> Model Features</a></li>
<li class="chapter" data-level="8" data-path="discussion.html"><a href="discussion.html#qq-plot-of-log-returns"><i class="fa fa-check"></i><b>8</b> QQ Plot of Log Returns</a></li>
<li class="chapter" data-level="9" data-path="discussion.html"><a href="discussion.html#returns-net-fees"><i class="fa fa-check"></i><b>9</b> Returns Net Fees</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modelling Altcoin Price Variation with Sentiment Based Predictors</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="results" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Results</h1>
<p>The hyperparameters for the models were tuned based on cross validation performed on the first 30 percent of the timeseries (1,060 data points) as shown in Figure <a href="4-results.html#fig:testing">4.1</a>. It should be noted that the test period was a particularly volatile interval for Zcash, which doubled before crashing back to below initial levels.</p>
<div class="figure" style="text-align: center"><span id="fig:testing"></span>
<img src="thesis_files/figure-html/testing-1.png" alt="Zcash Price Across Training, Validation and Testing Sets" width="672" />
<p class="caption">
Figure 4.1: Zcash Price Across Training, Validation and Testing Sets
</p>
</div>
<p>Performance was measured using anchored<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a> walk-forward testing, as seen in <span class="citation">(Żbikowski, 2014)</span>, in which one iteratively predicts test data point <span class="math inline">\(i\)</span> using a model trained on data points <span class="math inline">\((1:i-1)\)</span><a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a>. This avoids the issue of look-ahead bias that occurs when standard cross validation techniques are used on time series data, and allows us to best simulate a live trading algorithm. Walk-forward testing provides a more realistic measure of model performance as the model constantly updates to include new market conditions and tests the stability of the model to new data.</p>
<p>It should be noted that while the XGBoost model was retrained on the insertion of each new data point, due to time constraints and to reduce overfitting, the LSTM model was trained for one epoch every 50 new data points, approximately two days of data. Both models were trained to minimize root mean squared error.</p>
<div id="trading-strategies" class="section level2">
<h2><span class="header-section-number">4.1</span> Trading Strategies</h2>
<p>The following strategies described in Table <a href="4-results.html#tab:strats">4.1</a> were tested for both XGBoost and LSTM predictions, using the returns of holding Zcash as a baseline strategy. One advantage of using prediction percentiles instead of raw values to inform strategies is that it improves the balance between the number of buy/sell trades, reducing the impact of directional bias. I tested both an exponential decay and weighting by prediction value, however these approaches did not yield significantly better results. The percentiles of predictions were calculated for prediction <span class="math inline">\(i\)</span> on the set of predictions <span class="math inline">\((1:i)\)</span> with the notable exception being that the first ten percent of test data points were grouped together.</p>
<table>
<caption>
<span id="tab:strats">Table 4.1: </span>Strategy Descriptions
</caption>
<thead>
<tr>
<th style="text-align:left;">
Strategies
</th>
<th style="text-align:left;">
Descriptions
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Hold
</td>
<td style="text-align:left;">
Return of holding Zcash
</td>
</tr>
<tr>
<td style="text-align:left;">
All
</td>
<td style="text-align:left;">
Trade on every increment, direction in comparison to mean prediction
</td>
</tr>
<tr>
<td style="text-align:left;">
Top 20
</td>
<td style="text-align:left;">
Trade on the top and bottom 20 percent of predictions
</td>
</tr>
<tr>
<td style="text-align:left;">
Top 10
</td>
<td style="text-align:left;">
Trade on the top and bottom 10 percent of predictions
</td>
</tr>
</tbody>
</table>
<p>The predictions for the XGBoost and LSTM models are displayed below in Figures <a href="4-results.html#fig:xgboostTrades">4.2</a> and <a href="4-results.html#fig:lstmTrades">4.3</a>. The points are subsetted based on the Top 20 trading strategy. The XGBoost predictions are more evenly distributed throughout the time series, whereas the LSTM predictions follow clear trends.</p>
<div class="figure" style="text-align: center"><span id="fig:xgboostTrades"></span>
<img src="thesis_files/figure-html/xgboostTrades-1.png" alt="XGBoost Predictions" width="672" />
<p class="caption">
Figure 4.2: XGBoost Predictions
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:lstmTrades"></span>
<img src="thesis_files/figure-html/lstmTrades-1.png" alt="LSTM Predictions" width="672" />
<p class="caption">
Figure 4.3: LSTM Predictions
</p>
</div>
</div>
<div id="performance" class="section level2">
<h2><span class="header-section-number">4.2</span> Performance</h2>
<p>While the models achieved the best performance when trained on 4 hour log returns, we actually see that the performance accumulates past 4 hours. We see a monotonic increase in mean performance across all the strategies in Figure <a href="4-results.html#fig:pnltime">4.4</a> up to 5 hours after the trade. The LSTM and XGBoost Top 20 strategies return over a third of a percent per trade.</p>
<div class="figure" style="text-align: center"><span id="fig:pnltime"></span>
<img src="thesis_files/figure-html/pnltime-1.png" alt="Per Trade PNL" width="672" />
<p class="caption">
Figure 4.4: Per Trade PNL
</p>
</div>
<p>Per trade returns are slightly misleading as many signals overlap, resulting in actual profits that are much lower than pure sum of mean returns. Figures <a href="4-results.html#fig:xgboostPnls">4.5</a> and <a href="4-results.html#fig:LSTMPnls">4.6</a> display the theoretical returns of the strategies over the testing period. In the implementation of these strategies it is assumed that new signals override old predictions and after 5 hours of no prediction the position is closed.</p>
<div class="figure" style="text-align: center"><span id="fig:xgboostPnls"></span>
<img src="thesis_files/figure-html/xgboostPnls-1.png" alt="XGBoost Strategies PNL" width="672" />
<p class="caption">
Figure 4.5: XGBoost Strategies PNL
</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:LSTMPnls"></span>
<img src="thesis_files/figure-html/LSTMPnls-1.png" alt="LSTM Strategies PNL" width="672" />
<p class="caption">
Figure 4.6: LSTM Strategies PNL
</p>
</div>
<p>All three LSTM strategies outperform the most profitable XGBoost strategy. The LSTM All and Top 20 strategies both return over 200 percent in just over 100 days while the XGBoost Top 20 strategy also produces sizeable returns of 94 percent. Every strategy except the XGBoost Top 10 outperforms the market during this time period.</p>
While by no means a perfect metric, the Sharpe ratio is a strong proxy for risk adjusted returns. It is the average return
<span class="math display" id="eq:1">\[\begin{align}
  Sharpe = \frac{E(Return - R_f)}{sd(Return - R_f)}\tag{4.1} \\ 
\end{align}\]</span>
Using a risk free rate of 2%, Table <a href="#tab:sharpe"><strong>??</strong></a> displays the Sharpe ratio for the following strategies. Double digit Sharpe ratios are generally only achieved by the most sophisticated hedge funds.
<table>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
XGBoost Top 20
</th>
<th style="text-align:right;">
LSTM Top 20
</th>
<th style="text-align:right;">
LSTM All
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Sharpe Ratio
</td>
<td style="text-align:right;">
3.11
</td>
<td style="text-align:right;">
2.67
</td>
<td style="text-align:right;">
2.67
</td>
</tr>
</tbody>
</table>
</div>
<div id="performance-net-fees" class="section level2">
<h2><span class="header-section-number">4.3</span> Performance Net Fees</h2>
<p>Transaction costs represent a considerable expense in the cryptocurrency market. As a point of reference, Binance, one of the largest cryptocurrency exchanges, charges transaction fees of between 1.5 to 7.5 basis points<a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a>. While spreads are generally fairly negligible on liquid markets, during times of high volatility they can represent an additional 5-10 basis points. Table <a href="4-results.html#tab:feetable">4.2</a> displays the strategy profits assuming different fee structures. It is clear that even with substantial transaction fees these strategies remain profitable. However, when taking transaction fees into account it would be advantageous to only trade on the most profitable subset of signals.</p>
<table>
<caption>
<span id="tab:feetable">Table 4.2: </span>Percent Returns Net Fees
</caption>
<thead>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
15 bps
</th>
<th style="text-align:left;">
5 bps
</th>
<th style="text-align:left;">
2.5 bps
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
XGBoost Top 20
</td>
<td style="text-align:left;">
11.5%
</td>
<td style="text-align:left;">
61.3%
</td>
<td style="text-align:left;">
76.9%
</td>
</tr>
<tr>
<td style="text-align:left;">
LSTM Top 20
</td>
<td style="text-align:left;">
156.7%
</td>
<td style="text-align:left;">
187.4%
</td>
<td style="text-align:left;">
195.7%
</td>
</tr>
<tr>
<td style="text-align:left;">
LSTM All
</td>
<td style="text-align:left;">
134.7%
</td>
<td style="text-align:left;">
214.7%
</td>
<td style="text-align:left;">
238.6%
</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>Unanchored walk-forward testing uses a sliding window of training data to remove outdated datapoints. This is unnecessary given the scope of training data.<a href="4-results.html#fnref1">↩</a></p></li>
<li id="fn2"><p>As the model fits on four hour lagged returns, points <span class="math inline">\((i-4:i-1)\)</span> will be correlated with point <span class="math inline">\(i\)</span>; therefore, this process was modified to train on points <span class="math inline">\((1:i-5)\)</span>.<a href="4-results.html#fnref2">↩</a></p></li>
<li id="fn3"><p>One hundredth of one percent<a href="4-results.html#fnref3">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="3-method.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="discussion.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["thesis.pdf", "PDF"], ["thesis.epub", "EPUB"], ["thesis.docx", "Word"]],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
